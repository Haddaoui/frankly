<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../firebase-element/firebase-auth.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-styles/color.html">
<link rel="import" href="../paper-toolbar/paper-toolbar.html">


<dom-module id="dash-board">

  <template strip-whitespace>

    <style>
      :host {
        display: block;
        background: white;
        font-family: 'Roboto', 'Noto', sans-serif;
      }

      paper-toolbar {
        background-color: var(--paper-blue-grey-50);
        color: var(--paper-blue-grey-700);
        --paper-toolbar-title: {
          margin: 20px;
        }
      }

      paper-button {
        text-transform: none;
        margin: 0;
      }

      .avatar {
        border-radius: 50%;
        width: 36px;
        height: 36px;
        vertical-align: middle;
        margin-left: 16px;
      }

      .octocat-icon { fill: var(--paper-blue-grey-700); }
      .divider { padding: 0 0 0 16px; }

      .login-placeholder {
        max-width: 500px;
        text-align: center;
        margin: 100px auto;
      }
    </style>

    <paper-toolbar>
      <span class="title">[[title]]</span>

      <div hidden$="[[!githubUser]]">
        <span>{{githubUser.github.displayName}}</span>
        <img class="avatar" alt="github avatar" src="[[githubUser.github.profileImageURL]]">
        <span class="divider">|</span>
      </div>

      <paper-button on-tap="_onLoginTap">
        {{_buttonText(githubUser)}}
        <svg class="octocat-icon" hidden$="[[githubUser]]" height="16" width="16" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59 0.4 0.07 0.55-0.17 0.55-0.38 0-0.19-0.01-0.82-0.01-1.49-2.01 0.37-2.53-0.49-2.69-0.94-0.09-0.23-0.48-0.94-0.82-1.13-0.28-0.15-0.68-0.52-0.01-0.53 0.63-0.01 1.08 0.58 1.23 0.82 0.72 1.21 1.87 0.87 2.33 0.66 0.07-0.52 0.28-0.87 0.51-1.07-1.78-0.2-3.64-0.89-3.64-3.95 0-0.87 0.31-1.59 0.82-2.15-0.08-0.2-0.36-1.02 0.08-2.12 0 0 0.67-0.21 2.2 0.82 0.64-0.18 1.32-0.27 2-0.27 0.68 0 1.36 0.09 2 0.27 1.53-1.04 2.2-0.82 2.2-0.82 0.44 1.1 0.16 1.92 0.08 2.12 0.51 0.56 0.82 1.27 0.82 2.15 0 3.07-1.87 3.75-3.65 3.95 0.29 0.25 0.54 0.73 0.54 1.48 0 1.07-0.01 1.93-0.01 2.2 0 0.21 0.15 0.46 0.55 0.38C13.71 14.53 16 11.53 16 8 16 3.58 12.42 0 8 0z" />
        </svg>
      </paper-button>
    </paper-toolbar>

    <div class="login-placeholder" hidden$="[[githubUser]]">
      <h1><span style="font-weight:normal; font-size: 70px;">ðŸ™€</span></h1>
      <h1>You're not signed in!</h1>
      <p>You need to sign it with GitHub for this to work.</p>
    </div>

    <firebase-auth provider="github" id="githubAuth"
      location="https://grilled-cheese.firebaseio.com"
      user="{{githubUser}}">
    </firebase-auth>
  </template>

  <script>
    Polymer({
      is: 'dash-board',

      properties: {
        title: {
          type: String
        },

        githubUser: {
          type: Object
        }
      },

      // listeners: {
      //   'login': '_onLogin',
      //   'logout': '_onLogout'
      // },

      _buttonText: function(user) {
        return user ? 'Sign out' : 'Sign in with GitHub';
      },

      _onLoginTap: function() {
        if (this.githubUser) {
          this.$.githubAuth.logout();
        } else {
          this.$.githubAuth.login();
        }
      },
    });
  </script>
</dom-module>
